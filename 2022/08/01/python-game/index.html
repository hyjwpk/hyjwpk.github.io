<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="python-game, Hyjwpk">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>python-game | Hyjwpk</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Hyjwpk" type="application/atom+xml">
</head>

<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>


   <style>
    body{
       background-image: url(/medias/featureimages/4.jpg);
       background-repeat:no-repeat;
       background-size:cover;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hyjwpk</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hyjwpk</div>
        <div class="logo-desc">
            
            Persist, and anything will be within your reach.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/hyjwpk/hyjwpk.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #007FFF;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/hyjwpk/hyjwpk.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/3.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">python-game</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/python/">
                                <span class="chip bg-color">python</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%A4%A7%E4%BD%9C%E4%B8%9A/" class="post-category">
                                大作业
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-08-01
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2023-02-04
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    9.8k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    52 分
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="python-game"><a href="#python-game" class="headerlink" title="python-game"></a>python-game</h1><p>[Toc]</p>
<h2 id="小组成员"><a href="#小组成员" class="headerlink" title="小组成员"></a>小组成员</h2><p>PB20111696  王琛<br>PB20111697  王骥扬<br>PB20111699  吴骏东</p>
<h2 id="项目摘要"><a href="#项目摘要" class="headerlink" title="项目摘要"></a>项目摘要</h2><p>本项目借鉴<a target="_blank" rel="noopener" href="https://github.com/grantjenks/free-python-games">Free Python Games</a>使用turtle构建游戏界面，使用开源<a target="_blank" rel="noopener" href="https://github.com/deepmind/open_spiel">open_spiel</a>平台的游戏AI，加入<a target="_blank" rel="noopener" href="https://github.com/Uberi/speech_recognition">speech_recognition</a>的语音识别辅助游戏输入，支持<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Tic-tac-toe">Tictactoe</a> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Go_(game)">Go</a> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Y_(game)">Y</a> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Hex_(board_game)">Hex</a> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Havannah">Havannah</a>五种游戏，并对<a target="_blank" rel="noopener" href="https://github.com/grantjenks/free-python-games">Free Python Games</a>中的paint与snake进行拓展，同时对原 Free Python Games 中大部分的游戏进行了升级处理。完成了相对统一与独立的游戏封装，提高了可扩展性与可移植性。在Windows11和 Ubuntu 20.04.4 LTS 上测试通过。</p>
<h2 id="项目简介"><a href="#项目简介" class="headerlink" title="项目简介"></a>项目简介</h2><blockquote>
<p>OpenSpiel 是用于研究游戏中的强化学习和搜索/规划的环境和算法的集合。OpenSpiel 支持多种类型的游戏，在人数上包括单人与多人，在策略上支持零和、合作和一般和、在规则上支持一次性游戏和顺序游戏、在行动上支持严格轮流和同时行动、在信息上支持完美和不完美信息博弈。OpenSpiel 还包括分析学习动态和其他常见评估指标的工具。</p>
</blockquote>
<blockquote>
<p>Speech recognition 是一个Python的语音识别模块，支持多种语音线上、线下的语音识别模型。采用不同的语音识别模型，可以使用这些语音模型提供的特性，例如根据语法识别、识别特定关键字、识别首选短语，支持多种语言、方言。</p>
</blockquote>
<blockquote>
<p>Free Python Games 是一个 Apache2 许可的免费 Python 游戏集合，用于教育和娱乐。这些游戏是用简单的 Python 代码编写的，专为实验和更改而设计。包括几个经典街机游戏的简化版本。标准库有一个名为 Turtle 的模块，这是一种向孩子们介绍编程的流行方式。Free Python Games中的所有游戏都是使用 Python 及其 Turtle 模块实现的。可以在任何可以安装 Python 的地方运行，包括运行 Windows、Mac OS 或 Linux 的台式计算机以及较旧或低功耗的硬件。</p>
</blockquote>
<p>对于教育目的而言，本项目拓展了Free Python Games，增添了新的策略游戏，规则易懂，同时加入了OpenSpiel的游戏ai，使游戏具有可玩性，有助于学者在学习游戏制作的基础上进一步学习基于游戏背景的强化学习、搜索、最优化、估值算法，同时加入了语音识别模块，方便不适用于鼠标操控的场景。</p>
<p>对于研究目的而言，OpenSpiel 包含当前主流的强化学习算法，与时俱进，Speech recognition 是支持线上的语音识别模型，具有很强的可拓展性。本项目提供的简单图形界面易于实现，便于算法的实际测试与使用，具有实用性。</p>
<p>项目的技术难度主要在于实现一个统一的接口封装图形化界面、ai与语音识别，在避免复杂逻辑的情况下减少三者的耦合，从而使得项目易于学习与拓展。</p>
<h2 id="项目内容"><a href="#项目内容" class="headerlink" title="项目内容"></a>项目内容</h2><h3 id="项目目标"><a href="#项目目标" class="headerlink" title="项目目标"></a>项目目标</h3><p>实现OpenSpiel、Speech recognition、Free Python Games的协同工作。实现一个统一的接口封装图形化界面、ai与语音识别。</p>
<h3 id="基本原理与模型"><a href="#基本原理与模型" class="headerlink" title="基本原理与模型"></a>基本原理与模型</h3><p>项目的图形化界面使用python的turtle库实现。为实现OpenSpiel、Speech recognition、Free Python Games的协同工作，构建了一个基类<code>Game()</code>，在基类中实现ai的初始化，以及游戏的进行的函数。项目中的ai使用蒙特卡洛算法对游戏的状态空间进行搜索，只需将ai的初始化函数<code>init_bot(self, bot_type, game, simulations=1000)</code>修改即可实现模型的替换。</p>
<p>具体的游戏通过继承父类<code>Game()</code>实现，在子类中使用turtle库构建图形化界面，通过<code>turtle.onscreenclick()</code>增加游戏对于鼠标点击的响应，在触发的函数中调用OpenSpiel，获得ai的行动。若不需要ai，只需将触发函数中的ai调用删去即可。</p>
<p>语音识别通过在OpenSpiel的人类bot中，在输入部分调用语音模块实现。</p>
<h3 id="总体架构设计流程"><a href="#总体架构设计流程" class="headerlink" title="总体架构设计流程"></a>总体架构设计流程</h3><pre class="line-numbers language-mermaid" data-language="mermaid"><code class="language-mermaid">classDiagram
Game &lt;|-- Example

Game : __init__(self, name, show, type='mouse', simulations=1000)
Game : init_bot(self, bot_type, game, simulations=1000)
Game : init_game(self)
Game : play_game(self, position=None)

Example : _state
Example : players
Example : arr
Example : __init__()
Example : grid()
Example : draw_black()
Example : draw_white()
Example : draw()
Example : show()
Example : tap()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-mermaid" data-language="mermaid"><code class="language-mermaid">flowchart
    A[解析命令行参数] --&gt; B[初始化游戏界面]
    B --&gt; C[初始化ai]
    C --&gt; D[添加鼠标触发函数]
    D --&gt; E[等待鼠标点击事件]
    E --&gt; F[ai响应]
    F --&gt; G[游戏结束]
    F --&gt; E
    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-mermaid" data-language="mermaid"><code class="language-mermaid">flowchart
    A[解析命令行参数] --&gt; B[初始化游戏界面]
    B --&gt; C[初始化ai]
    C --&gt; D[等待语音输入]
    D --&gt; E[ai响应]
    E --&gt; F[游戏结束]
    E --&gt; D<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="项目具体实现"><a href="#项目具体实现" class="headerlink" title="项目具体实现"></a>项目具体实现</h3><h4 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h4><p>项目在Windows11和 Ubuntu 20.04.4 LTS 上测试通过</p>
<p>conda 4.13.0</p>
<p>执行<code>conda create -n openspiel python=3.9</code>创建python3.9环境</p>
<p>执行<code>conda activate openspiel</code>激活环境</p>
<h5 id="open-spiel"><a href="#open-spiel" class="headerlink" title="open_spiel"></a>open_spiel</h5><h6 id="Ubuntu-20-04-4-LTS"><a href="#Ubuntu-20-04-4-LTS" class="headerlink" title="Ubuntu 20.04.4 LTS"></a>Ubuntu 20.04.4 LTS</h6><p>执行<code>pip install open_spiel</code>安装open_spiel</p>
<p>执行<code>pip install tensorflow  </code> 安装open_spiel所需库</p>
<blockquote>
<p>参考版本如下</p>
<p>open-spiel                   1.0.2</p>
<p>tensorflow                   2.9.1</p>
</blockquote>
<h6 id="Windows11"><a href="#Windows11" class="headerlink" title="Windows11"></a>Windows11</h6><p>从github上clone项目，具体操作如下</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>MyUser
<span class="token function">git</span> clone https://github.com/deepmind/open_spiel.git
<span class="token builtin class-name">cd</span> open_spiel
<span class="token function">git</span> clone -b smart_holder --single-branch --depth <span class="token number">1</span> https://github.com/pybind/pybind11.git pybind11
<span class="token function">git</span> clone -b <span class="token number">20211102.0</span> --single-branch --depth <span class="token number">1</span> https://github.com/abseil/abseil-cpp.git open_spiel<span class="token punctuation">\</span>abseil-cpp
<span class="token function">git</span> clone -b develop --single-branch --depth <span class="token number">1</span> https://github.com/jblespiau/dds.git open_spiel<span class="token punctuation">\</span>games<span class="token punctuation">\</span>bridge<span class="token punctuation">\</span>double_dummy_solver<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用CMake 根据 C:\Users\MyUser\open_spiel\open_spiel\CMakeLists.txt编译整个项目，可以从官网安装CMake或使用Visual Studio打开CMake项目进行编译，将编译得到的pyspiel库放置于python环境的site-packages下，并把C:\Users\MyUser\open_spiel\open_spiel\python复制到site-packages下</p>
<p>执行<code>pip install absl-py attrs numpy tensorflow</code>  安装open_spiel所需库</p>
<blockquote>
<p>参考版本如下</p>
<p>absl-py                      1.1.0</p>
<p>attrs                        21.4.0</p>
<p>numpy                        1.23.0</p>
<p>tensorflow                   2.9.1</p>
</blockquote>
<h5 id="speech-recognition"><a href="#speech-recognition" class="headerlink" title="speech-recognition"></a>speech-recognition</h5><p>从github clone <a target="_blank" rel="noopener" href="https://github.com/Uberi/speech_recognition">speech_recognition</a>项目</p>
<p>在clone的项目下执行<code>python setup.py install</code>安装speech-recognition</p>
<p>执行<code> sudo apt-get install libasound-dev portaudio19-dev libportaudio2 libportaudiocpp0</code>安装PyAudio的依赖</p>
<p>执行<code>pip install PyAudio Vosk </code> 安装speech-recognition所需库</p>
<blockquote>
<p>参考版本如下</p>
<p>PyAudio             0.2.11</p>
<p>vosk                0.3.42</p>
</blockquote>
<p>下载vosk的中文<a target="_blank" rel="noopener" href="https://alphacephei.com/vosk/models">model</a>并解压于根目录model文件夹下，参考模型为<a target="_blank" rel="noopener" href="https://alphacephei.com/vosk/models/vosk-model-cn-0.22.zip">vosk-model-cn-0.22</a></p>
<blockquote>
<p>model文件夹目录结构为</p>
<p>├── model<br>│   ├── am<br>│   │   └── final.mdl<br>│   ├── conf<br>│   │   ├── mfcc.conf<br>│   │   └── model.conf<br>│   ├── graph<br>│   │   ├── HCLG.fst<br>│   │   ├── phones<br>│   │   │   └── word_boundary.int<br>│   │   └── words.txt<br>│   ├── ivector<br>│   │   ├── final.dubm<br>│   │   ├── final.ie<br>│   │   ├── final.mat<br>│   │   ├── global_cmvn.stats<br>│   │   ├── online_cmvn.conf<br>│   │   └── splice.conf<br>│   ├── README<br>│   ├── rescore<br>│   │   ├── G.carpa<br>│   │   └── G.fst<br>│   └── rnnlm<br>│       ├── feat_embedding.final.mat<br>│       ├── features.txt<br>│       ├── final.raw<br>│       ├── oov.txt<br>│       ├── special_symbol_opts.conf<br>│       ├── special_symbol_opts.txt<br>│       └── word_feats.txt</p>
</blockquote>
<h5 id="freegames"><a href="#freegames" class="headerlink" title="freegames"></a>freegames</h5><p>执行<code>pip install freegames</code>安装freegames</p>
<p>参考版本如下</p>
<p>freegames                    2.4.0</p>
<h4 id="输入输出"><a href="#输入输出" class="headerlink" title="输入输出"></a>输入输出</h4><p>在根目录下执行python main.py -h 查看命令行参数说明</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">usage: main.py <span class="token punctuation">[</span>-h<span class="token punctuation">]</span> <span class="token punctuation">[</span>-g GAME<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t TYPE<span class="token punctuation">]</span> <span class="token punctuation">[</span>-s SIMULATIONS<span class="token punctuation">]</span>

Free_Python_Game <span class="token operator">&amp;</span> Open_Spiel <span class="token operator">&amp;</span> Speech_Recognition

optional arguments:
  -h, --help            show this <span class="token builtin class-name">help</span> message and <span class="token builtin class-name">exit</span>
  -g GAME, --game GAME  game name: Tictactoe、Go、Y、Hex、Havannah、snake、paint、Ant
                        、Bagles、Boom、Bounce、Cannon、Connect、Crypto、Fidget、Flapp
                        y、Guess、Life、Madlibs、Maze、Memory、Minesweeper、Pacman、Pa
                        int、Pong、Rps_game、Simonsays、Snake、Tictactoe、Tiles、Tron
  -t TYPE, --type TYPE  mouse or voice
  -s SIMULATIONS, --simulations SIMULATIONS
                        How many iterations of MCTS to perform<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用-g 指定游戏名称，使用-t 指定输入类型（mouse或voice），使用-s 指定蒙特卡洛迭代次数</p>
<p>在关于open_speil五个游戏中，三个参数均为可选，-g 默认为Tictactoe，-t 默认为mouse，-s 默认为 1000；其余游戏只可支持第一个参数</p>
<p>例如 python main.py -g=Go 即可启动Go游戏</p>
<p>游戏中均为ai先手，第一步可能需要等待一段时间</p>
<h4 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h4><h5 id="命令行参数解析"><a href="#命令行参数解析" class="headerlink" title="命令行参数解析"></a>命令行参数解析</h5><p>使用 argparse 实现命令行参数的解析，可用的命令行参数有游戏名称（[‘Tictactoe’, ‘Go’, ‘Y’, ‘Hex’, ‘Havannah’]， 以及 free-python-game 中支持的游戏名称）、输入方式（鼠标或语音）、蒙特卡洛算法迭代次数（次数越高ai水平越高，消耗时间随迭代次数线性增长）</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> argparse
<span class="token keyword">from</span> openspiel<span class="token punctuation">.</span>game<span class="token punctuation">.</span>Tictactoe <span class="token keyword">import</span> Tictactoe
<span class="token keyword">from</span> openspiel<span class="token punctuation">.</span>game<span class="token punctuation">.</span>Go <span class="token keyword">import</span> Go
<span class="token keyword">from</span> openspiel<span class="token punctuation">.</span>game<span class="token punctuation">.</span>Y <span class="token keyword">import</span> Y
<span class="token keyword">from</span> openspiel<span class="token punctuation">.</span>game<span class="token punctuation">.</span>Hex <span class="token keyword">import</span> Hex
<span class="token keyword">from</span> openspiel<span class="token punctuation">.</span>game<span class="token punctuation">.</span>Havannah <span class="token keyword">import</span> Havannah
<span class="token keyword">import</span> freegames_extern<span class="token punctuation">.</span>snake
<span class="token keyword">import</span> freegames_extern<span class="token punctuation">.</span>paint
<span class="token keyword">import</span> os

path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'/freegames'</span>

freegameslist <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'Ant'</span><span class="token punctuation">,</span>
    <span class="token string">'Bagles'</span><span class="token punctuation">,</span>
    <span class="token string">'Boom'</span><span class="token punctuation">,</span>
    <span class="token string">'Bounce'</span><span class="token punctuation">,</span>
    <span class="token string">'Cannon'</span><span class="token punctuation">,</span>
    <span class="token string">'Connect'</span><span class="token punctuation">,</span>
    <span class="token string">'Crypto'</span><span class="token punctuation">,</span>
    <span class="token string">'Fidget'</span><span class="token punctuation">,</span>
    <span class="token string">'Flappy'</span><span class="token punctuation">,</span>
    <span class="token string">'Guess'</span><span class="token punctuation">,</span>
    <span class="token string">'Life'</span><span class="token punctuation">,</span>
    <span class="token string">'Madlibs'</span><span class="token punctuation">,</span>
    <span class="token string">'Maze'</span><span class="token punctuation">,</span>
    <span class="token string">'Memory'</span><span class="token punctuation">,</span>
    <span class="token string">'Minesweeper'</span><span class="token punctuation">,</span>
    <span class="token string">'Pacman'</span><span class="token punctuation">,</span>
    <span class="token string">'Paint'</span><span class="token punctuation">,</span>
    <span class="token string">'Pong'</span><span class="token punctuation">,</span>
    <span class="token string">'Rps_game'</span><span class="token punctuation">,</span>
    <span class="token string">'Simonsays'</span><span class="token punctuation">,</span>
    <span class="token string">'Snake'</span><span class="token punctuation">,</span>
    <span class="token string">'Tictactoe'</span><span class="token punctuation">,</span>
    <span class="token string">'Tiles'</span><span class="token punctuation">,</span>
    <span class="token string">'Tron'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    gamename <span class="token operator">=</span> <span class="token string">'game name: Tictactoe、Go、Y、Hex、Havannah、snake、paint'</span>
    <span class="token keyword">for</span> game <span class="token keyword">in</span> freegameslist<span class="token punctuation">:</span>
        gamename <span class="token operator">=</span> gamename <span class="token operator">+</span> <span class="token string">'、'</span> <span class="token operator">+</span> game
        
    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>
        description<span class="token operator">=</span><span class="token string">"Free_Python_Game &amp; Open_Spiel &amp; Speech_Recognition"</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-g'</span><span class="token punctuation">,</span> <span class="token string">'--game'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'Tictactoe'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span>gamename<span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-t'</span><span class="token punctuation">,</span> <span class="token string">'--type'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'mouse'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'mouse or voice'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-s'</span><span class="token punctuation">,</span> <span class="token string">'--simulations'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span>
                        <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'How many iterations of MCTS to perform'</span><span class="token punctuation">)</span>
    args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># game_list = ['Tictactoe', 'Go', 'Y', 'Hex', 'Havannah', 'snake', 'paint']</span>
    
    <span class="token keyword">if</span> args<span class="token punctuation">.</span>game <span class="token operator">==</span> <span class="token string">'Tictactoe'</span><span class="token punctuation">:</span>
        Tictactoe<span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>simulations<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>game <span class="token operator">==</span> <span class="token string">'Go'</span><span class="token punctuation">:</span>
        Go<span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>simulations<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>game <span class="token operator">==</span> <span class="token string">'Y'</span><span class="token punctuation">:</span>
        Y<span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>simulations<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>game <span class="token operator">==</span> <span class="token string">'Hex'</span><span class="token punctuation">:</span>
        Hex<span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>simulations<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>game <span class="token operator">==</span> <span class="token string">'Havannah'</span><span class="token punctuation">:</span>
        Havannah<span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>simulations<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>game <span class="token operator">==</span> <span class="token string">'snake'</span><span class="token punctuation">:</span>
        freegames_extern<span class="token punctuation">.</span>snake<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>game <span class="token operator">==</span> <span class="token string">'paint'</span><span class="token punctuation">:</span>
        freegames_extern<span class="token punctuation">.</span>paint<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>game <span class="token keyword">in</span> freegameslist<span class="token punctuation">:</span>
        name <span class="token operator">=</span> <span class="token string">'/'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>game<span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.py'</span>
        os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'python '</span> <span class="token operator">+</span> path <span class="token operator">+</span> name<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="蒙特卡洛算法（开源）"><a href="#蒙特卡洛算法（开源）" class="headerlink" title="蒙特卡洛算法（开源）"></a>蒙特卡洛算法（开源）</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Copyright 2019 DeepMind Technologies Ltd. All rights reserved.</span>
<span class="token comment">#</span>
<span class="token comment"># Licensed under the Apache License, Version 2.0 (the "License");</span>
<span class="token comment"># you may not use this file except in compliance with the License.</span>
<span class="token comment"># You may obtain a copy of the License at</span>
<span class="token comment">#</span>
<span class="token comment">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="token comment">#</span>
<span class="token comment"># Unless required by applicable law or agreed to in writing, software</span>
<span class="token comment"># distributed under the License is distributed on an "AS IS" BASIS,</span>
<span class="token comment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="token comment"># See the License for the specific language governing permissions and</span>
<span class="token comment"># limitations under the License.</span>

<span class="token triple-quoted-string string">"""Monte-Carlo Tree Search algorithm for game play."""</span>

<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> absolute_import
<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> division
<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function

<span class="token keyword">import</span> math
<span class="token keyword">import</span> time

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">import</span> pyspiel


<span class="token keyword">class</span> <span class="token class-name">Evaluator</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""Abstract class representing an evaluation function for a game.

  The evaluation function takes in an intermediate state in the game and returns
  an evaluation of that state, which should correlate with chances of winning
  the game. It returns the evaluation from all player's perspectives.
  """</span>

  <span class="token keyword">def</span> <span class="token function">evaluate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns evaluation on given state."""</span>
    <span class="token keyword">raise</span> NotImplementedError

  <span class="token keyword">def</span> <span class="token function">prior</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns a probability for each legal action in the given state."""</span>
    <span class="token keyword">raise</span> NotImplementedError


<span class="token keyword">class</span> <span class="token class-name">RandomRolloutEvaluator</span><span class="token punctuation">(</span>Evaluator<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""A simple evaluator doing random rollouts.

  This evaluator returns the average outcome of playing random actions from the
  given state until the end of the game.  n_rollouts is the number of random
  outcomes to be considered.
  """</span>

  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n_rollouts<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>n_rollouts <span class="token operator">=</span> n_rollouts
    self<span class="token punctuation">.</span>_random_state <span class="token operator">=</span> random_state <span class="token keyword">or</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>RandomState<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">evaluate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns evaluation on given state."""</span>
    result <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>n_rollouts<span class="token punctuation">)</span><span class="token punctuation">:</span>
      working_state <span class="token operator">=</span> state<span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">while</span> <span class="token keyword">not</span> working_state<span class="token punctuation">.</span>is_terminal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> working_state<span class="token punctuation">.</span>is_chance_node<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
          outcomes <span class="token operator">=</span> working_state<span class="token punctuation">.</span>chance_outcomes<span class="token punctuation">(</span><span class="token punctuation">)</span>
          action_list<span class="token punctuation">,</span> prob_list <span class="token operator">=</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>outcomes<span class="token punctuation">)</span>
          action <span class="token operator">=</span> self<span class="token punctuation">.</span>_random_state<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>action_list<span class="token punctuation">,</span> p<span class="token operator">=</span>prob_list<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
          action <span class="token operator">=</span> self<span class="token punctuation">.</span>_random_state<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>working_state<span class="token punctuation">.</span>legal_actions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        working_state<span class="token punctuation">.</span>apply_action<span class="token punctuation">(</span>action<span class="token punctuation">)</span>
      returns <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>working_state<span class="token punctuation">.</span>returns<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      result <span class="token operator">=</span> returns <span class="token keyword">if</span> result <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">else</span> result <span class="token operator">+</span> returns

    <span class="token keyword">return</span> result <span class="token operator">/</span> self<span class="token punctuation">.</span>n_rollouts

  <span class="token keyword">def</span> <span class="token function">prior</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns equal probability for all actions."""</span>
    <span class="token keyword">if</span> state<span class="token punctuation">.</span>is_chance_node<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">.</span>chance_outcomes<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
      legal_actions <span class="token operator">=</span> state<span class="token punctuation">.</span>legal_actions<span class="token punctuation">(</span>state<span class="token punctuation">.</span>current_player<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>legal_actions<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> action <span class="token keyword">in</span> legal_actions<span class="token punctuation">]</span>


<span class="token keyword">class</span> <span class="token class-name">SearchNode</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""A node in the search tree.

  A SearchNode represents a state and possible continuations from it. Each child
  represents a possible action, and the expected result from doing so.

  Attributes:
    action: The action from the parent node's perspective. Not important for the
      root node, as the actions that lead to it are in the past.
    player: Which player made this action.
    prior: A prior probability for how likely this action will be selected.
    explore_count: How many times this node was explored.
    total_reward: The sum of rewards of rollouts through this node, from the
      parent node's perspective. The average reward of this node is
      `total_reward / explore_count`
    outcome: The rewards for all players if this is a terminal node or the
      subtree has been proven, otherwise None.
    children: A list of SearchNodes representing the possible actions from this
      node, along with their expected rewards.
  """</span>
  __slots__ <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token string">"action"</span><span class="token punctuation">,</span>
      <span class="token string">"player"</span><span class="token punctuation">,</span>
      <span class="token string">"prior"</span><span class="token punctuation">,</span>
      <span class="token string">"explore_count"</span><span class="token punctuation">,</span>
      <span class="token string">"total_reward"</span><span class="token punctuation">,</span>
      <span class="token string">"outcome"</span><span class="token punctuation">,</span>
      <span class="token string">"children"</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>

  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">,</span> player<span class="token punctuation">,</span> prior<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>action <span class="token operator">=</span> action
    self<span class="token punctuation">.</span>player <span class="token operator">=</span> player
    self<span class="token punctuation">.</span>prior <span class="token operator">=</span> prior
    self<span class="token punctuation">.</span>explore_count <span class="token operator">=</span> <span class="token number">0</span>
    self<span class="token punctuation">.</span>total_reward <span class="token operator">=</span> <span class="token number">0.0</span>
    self<span class="token punctuation">.</span>outcome <span class="token operator">=</span> <span class="token boolean">None</span>
    self<span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token keyword">def</span> <span class="token function">uct_value</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent_explore_count<span class="token punctuation">,</span> uct_c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns the UCT value of child."""</span>
    <span class="token keyword">if</span> self<span class="token punctuation">.</span>outcome <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> self<span class="token punctuation">.</span>outcome<span class="token punctuation">[</span>self<span class="token punctuation">.</span>player<span class="token punctuation">]</span>

    <span class="token keyword">if</span> self<span class="token punctuation">.</span>explore_count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">"inf"</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> self<span class="token punctuation">.</span>total_reward <span class="token operator">/</span> self<span class="token punctuation">.</span>explore_count <span class="token operator">+</span> uct_c <span class="token operator">*</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>
        math<span class="token punctuation">.</span>log<span class="token punctuation">(</span>parent_explore_count<span class="token punctuation">)</span> <span class="token operator">/</span> self<span class="token punctuation">.</span>explore_count<span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">puct_value</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent_explore_count<span class="token punctuation">,</span> uct_c<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns the PUCT value of child."""</span>
    <span class="token keyword">if</span> self<span class="token punctuation">.</span>outcome <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> self<span class="token punctuation">.</span>outcome<span class="token punctuation">[</span>self<span class="token punctuation">.</span>player<span class="token punctuation">]</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>explore_count <span class="token keyword">and</span> self<span class="token punctuation">.</span>total_reward <span class="token operator">/</span> self<span class="token punctuation">.</span>explore_count<span class="token punctuation">)</span> <span class="token operator">+</span>
            uct_c <span class="token operator">*</span> self<span class="token punctuation">.</span>prior <span class="token operator">*</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>parent_explore_count<span class="token punctuation">)</span> <span class="token operator">/</span>
            <span class="token punctuation">(</span>self<span class="token punctuation">.</span>explore_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">sort_key</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns the best action from this node, either proven or most visited.

    This ordering leads to choosing:
    - Highest proven score &gt; 0 over anything else, including a promising but
      unproven action.
    - A proven draw only if it has higher exploration than others that are
      uncertain, or the others are losses.
    - Uncertain action with most exploration over loss of any difficulty
    - Hardest loss if everything is a loss
    - Highest expected reward if explore counts are equal (unlikely).
    - Longest win, if multiple are proven (unlikely due to early stopping).
    """</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>outcome <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">else</span> self<span class="token punctuation">.</span>outcome<span class="token punctuation">[</span>self<span class="token punctuation">.</span>player<span class="token punctuation">]</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>explore_count<span class="token punctuation">,</span> self<span class="token punctuation">.</span>total_reward<span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">best_child</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns the best child in order of the sort key."""</span>
    <span class="token keyword">return</span> <span class="token builtin">max</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>children<span class="token punctuation">,</span> key<span class="token operator">=</span>SearchNode<span class="token punctuation">.</span>sort_key<span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">children_str</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns the string representation of this node's children.

    They are ordered based on the sort key, so order of being chosen to play.

    Args:
      state: A `pyspiel.State` object, to be used to convert the action id into
        a human readable format. If None, the action integer id is used.
    """</span>
    <span class="token keyword">return</span> <span class="token string">"\n"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>
        c<span class="token punctuation">.</span>to_str<span class="token punctuation">(</span>state<span class="token punctuation">)</span>
        <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>children<span class="token punctuation">,</span> key<span class="token operator">=</span>SearchNode<span class="token punctuation">.</span>sort_key<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">to_str</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns the string representation of this node.

    Args:
      state: A `pyspiel.State` object, to be used to convert the action id into
        a human readable format. If None, the action integer id is used.
    """</span>
    action <span class="token operator">=</span> <span class="token punctuation">(</span>
        state<span class="token punctuation">.</span>action_to_string<span class="token punctuation">(</span>state<span class="token punctuation">.</span>current_player<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>action<span class="token punctuation">)</span>
        <span class="token keyword">if</span> state <span class="token keyword">and</span> self<span class="token punctuation">.</span>action <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">else</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>action<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token string">"{:&gt;6}: player: {}, prior: {:5.3f}, value: {:6.3f}, sims: {:5d}, "</span>
            <span class="token string">"outcome: {}, {:3d} children"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                action<span class="token punctuation">,</span> self<span class="token punctuation">.</span>player<span class="token punctuation">,</span> self<span class="token punctuation">.</span>prior<span class="token punctuation">,</span> self<span class="token punctuation">.</span>explore_count <span class="token keyword">and</span>
                self<span class="token punctuation">.</span>total_reward <span class="token operator">/</span> self<span class="token punctuation">.</span>explore_count<span class="token punctuation">,</span> self<span class="token punctuation">.</span>explore_count<span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token string">"{:4.1f}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>outcome<span class="token punctuation">[</span>self<span class="token punctuation">.</span>player<span class="token punctuation">]</span><span class="token punctuation">)</span>
                 <span class="token keyword">if</span> self<span class="token punctuation">.</span>outcome <span class="token keyword">else</span> <span class="token string">"none"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> self<span class="token punctuation">.</span>to_str<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">MCTSBot</span><span class="token punctuation">(</span>pyspiel<span class="token punctuation">.</span>Bot<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""Bot that uses Monte-Carlo Tree Search algorithm."""</span>

  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>
               game<span class="token punctuation">,</span>
               uct_c<span class="token punctuation">,</span>
               max_simulations<span class="token punctuation">,</span>
               evaluator<span class="token punctuation">,</span>
               solve<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
               random_state<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
               child_selection_fn<span class="token operator">=</span>SearchNode<span class="token punctuation">.</span>uct_value<span class="token punctuation">,</span>
               dirichlet_noise<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
               verbose<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Initializes a MCTS Search algorithm in the form of a bot.

    In multiplayer games, or non-zero-sum games, the players will play the
    greedy strategy.

    Args:
      game: A pyspiel.Game to play.
      uct_c: The exploration constant for UCT.
      max_simulations: How many iterations of MCTS to perform. Each simulation
        will result in one call to the evaluator. Memory usage should grow
        linearly with simulations * branching factor. How many nodes in the
        search tree should be evaluated. This is correlated with memory size and
        tree depth.
      evaluator: A `Evaluator` object to use to evaluate a leaf node.
      solve: Whether to back up solved states.
      random_state: An optional numpy RandomState to make it deterministic.
      child_selection_fn: A function to select the child in the descent phase.
        The default is UCT.
      dirichlet_noise: A tuple of (epsilon, alpha) for adding dirichlet noise to
        the policy at the root. This is from the alpha-zero paper.
      verbose: Whether to print information about the search tree before
        returning the action. Useful for confirming the search is working
        sensibly.

    Raises:
      ValueError: if the game type isn't supported.
    """</span>
    pyspiel<span class="token punctuation">.</span>Bot<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
    <span class="token comment"># Check that the game satisfies the conditions for this MCTS implemention.</span>
    game_type <span class="token operator">=</span> game<span class="token punctuation">.</span>get_type<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> game_type<span class="token punctuation">.</span>reward_model <span class="token operator">!=</span> pyspiel<span class="token punctuation">.</span>GameType<span class="token punctuation">.</span>RewardModel<span class="token punctuation">.</span>TERMINAL<span class="token punctuation">:</span>
      <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"Game must have terminal rewards."</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> game_type<span class="token punctuation">.</span>dynamics <span class="token operator">!=</span> pyspiel<span class="token punctuation">.</span>GameType<span class="token punctuation">.</span>Dynamics<span class="token punctuation">.</span>SEQUENTIAL<span class="token punctuation">:</span>
      <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"Game must have sequential turns."</span><span class="token punctuation">)</span>

    self<span class="token punctuation">.</span>_game <span class="token operator">=</span> game
    self<span class="token punctuation">.</span>uct_c <span class="token operator">=</span> uct_c
    self<span class="token punctuation">.</span>max_simulations <span class="token operator">=</span> max_simulations
    self<span class="token punctuation">.</span>evaluator <span class="token operator">=</span> evaluator
    self<span class="token punctuation">.</span>verbose <span class="token operator">=</span> verbose
    self<span class="token punctuation">.</span>solve <span class="token operator">=</span> solve
    self<span class="token punctuation">.</span>max_utility <span class="token operator">=</span> game<span class="token punctuation">.</span>max_utility<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>_dirichlet_noise <span class="token operator">=</span> dirichlet_noise
    self<span class="token punctuation">.</span>_random_state <span class="token operator">=</span> random_state <span class="token keyword">or</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>RandomState<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>_child_selection_fn <span class="token operator">=</span> child_selection_fn

  <span class="token keyword">def</span> <span class="token function">restart_at</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

  <span class="token keyword">def</span> <span class="token function">step_with_policy</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns bot's policy and action at given state."""</span>
    t1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root <span class="token operator">=</span> self<span class="token punctuation">.</span>mcts_search<span class="token punctuation">(</span>state<span class="token punctuation">)</span>

    best <span class="token operator">=</span> root<span class="token punctuation">.</span>best_child<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> self<span class="token punctuation">.</span>verbose<span class="token punctuation">:</span>
      seconds <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t1
      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished {} sims in {:.3f} secs, {:.1f} sims/s"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
          root<span class="token punctuation">.</span>explore_count<span class="token punctuation">,</span> seconds<span class="token punctuation">,</span> root<span class="token punctuation">.</span>explore_count <span class="token operator">/</span> seconds<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Root:"</span><span class="token punctuation">)</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>to_str<span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Children:"</span><span class="token punctuation">)</span>
      <span class="token keyword">print</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>children_str<span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> best<span class="token punctuation">.</span>children<span class="token punctuation">:</span>
        chosen_state <span class="token operator">=</span> state<span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span>
        chosen_state<span class="token punctuation">.</span>apply_action<span class="token punctuation">(</span>best<span class="token punctuation">.</span>action<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Children of chosen:"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>best<span class="token punctuation">.</span>children_str<span class="token punctuation">(</span>chosen_state<span class="token punctuation">)</span><span class="token punctuation">)</span>

    mcts_action <span class="token operator">=</span> best<span class="token punctuation">.</span>action

    policy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token keyword">if</span> action <span class="token operator">==</span> mcts_action <span class="token keyword">else</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token keyword">for</span> action <span class="token keyword">in</span> state<span class="token punctuation">.</span>legal_actions<span class="token punctuation">(</span>state<span class="token punctuation">.</span>current_player<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token keyword">return</span> policy<span class="token punctuation">,</span> mcts_action

  <span class="token keyword">def</span> <span class="token function">step</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> self<span class="token punctuation">.</span>step_with_policy<span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

  <span class="token keyword">def</span> <span class="token function">_apply_tree_policy</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> root<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Applies the UCT policy to play the game until reaching a leaf node.

    A leaf node is defined as a node that is terminal or has not been evaluated
    yet. If it reaches a node that has been evaluated before but hasn't been
    expanded, then expand it's children and continue.

    Args:
      root: The root node in the search tree.
      state: The state of the game at the root node.

    Returns:
      visit_path: A list of nodes descending from the root node to a leaf node.
      working_state: The state of the game at the leaf node.
    """</span>
    visit_path <span class="token operator">=</span> <span class="token punctuation">[</span>root<span class="token punctuation">]</span>
    working_state <span class="token operator">=</span> state<span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span>
    current_node <span class="token operator">=</span> root
    <span class="token keyword">while</span> <span class="token keyword">not</span> working_state<span class="token punctuation">.</span>is_terminal<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">and</span> current_node<span class="token punctuation">.</span>explore_count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
      <span class="token keyword">if</span> <span class="token keyword">not</span> current_node<span class="token punctuation">.</span>children<span class="token punctuation">:</span>
        <span class="token comment"># For a new node, initialize its state, then choose a child as normal.</span>
        legal_actions <span class="token operator">=</span> self<span class="token punctuation">.</span>evaluator<span class="token punctuation">.</span>prior<span class="token punctuation">(</span>working_state<span class="token punctuation">)</span>
        <span class="token keyword">if</span> current_node <span class="token keyword">is</span> root <span class="token keyword">and</span> self<span class="token punctuation">.</span>_dirichlet_noise<span class="token punctuation">:</span>
          epsilon<span class="token punctuation">,</span> alpha <span class="token operator">=</span> self<span class="token punctuation">.</span>_dirichlet_noise
          noise <span class="token operator">=</span> self<span class="token punctuation">.</span>_random_state<span class="token punctuation">.</span>dirichlet<span class="token punctuation">(</span><span class="token punctuation">[</span>alpha<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>legal_actions<span class="token punctuation">)</span><span class="token punctuation">)</span>
          legal_actions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> epsilon<span class="token punctuation">)</span> <span class="token operator">*</span> p <span class="token operator">+</span> epsilon <span class="token operator">*</span> n<span class="token punctuation">)</span>
                           <span class="token keyword">for</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">,</span> n <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>legal_actions<span class="token punctuation">,</span> noise<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token comment"># Reduce bias from move generation order.</span>
        self<span class="token punctuation">.</span>_random_state<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>legal_actions<span class="token punctuation">)</span>
        player <span class="token operator">=</span> working_state<span class="token punctuation">.</span>current_player<span class="token punctuation">(</span><span class="token punctuation">)</span>
        current_node<span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token punctuation">[</span>
            SearchNode<span class="token punctuation">(</span>action<span class="token punctuation">,</span> player<span class="token punctuation">,</span> prior<span class="token punctuation">)</span> <span class="token keyword">for</span> action<span class="token punctuation">,</span> prior <span class="token keyword">in</span> legal_actions
        <span class="token punctuation">]</span>

      <span class="token keyword">if</span> working_state<span class="token punctuation">.</span>is_chance_node<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># For chance nodes, rollout according to chance node's probability</span>
        <span class="token comment"># distribution</span>
        outcomes <span class="token operator">=</span> working_state<span class="token punctuation">.</span>chance_outcomes<span class="token punctuation">(</span><span class="token punctuation">)</span>
        action_list<span class="token punctuation">,</span> prob_list <span class="token operator">=</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>outcomes<span class="token punctuation">)</span>
        action <span class="token operator">=</span> self<span class="token punctuation">.</span>_random_state<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>action_list<span class="token punctuation">,</span> p<span class="token operator">=</span>prob_list<span class="token punctuation">)</span>
        chosen_child <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>
            c <span class="token keyword">for</span> c <span class="token keyword">in</span> current_node<span class="token punctuation">.</span>children <span class="token keyword">if</span> c<span class="token punctuation">.</span>action <span class="token operator">==</span> action<span class="token punctuation">)</span>
      <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># Otherwise choose node with largest UCT value</span>
        chosen_child <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>
            current_node<span class="token punctuation">.</span>children<span class="token punctuation">,</span>
            key<span class="token operator">=</span><span class="token keyword">lambda</span> c<span class="token punctuation">:</span> self<span class="token punctuation">.</span>_child_selection_fn<span class="token punctuation">(</span>  <span class="token comment"># pylint: disable=g-long-lambda</span>
                c<span class="token punctuation">,</span> current_node<span class="token punctuation">.</span>explore_count<span class="token punctuation">,</span> self<span class="token punctuation">.</span>uct_c<span class="token punctuation">)</span><span class="token punctuation">)</span>

      working_state<span class="token punctuation">.</span>apply_action<span class="token punctuation">(</span>chosen_child<span class="token punctuation">.</span>action<span class="token punctuation">)</span>
      current_node <span class="token operator">=</span> chosen_child
      visit_path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current_node<span class="token punctuation">)</span>

    <span class="token keyword">return</span> visit_path<span class="token punctuation">,</span> working_state

  <span class="token keyword">def</span> <span class="token function">mcts_search</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""A vanilla Monte-Carlo Tree Search algorithm.

    This algorithm searches the game tree from the given state.
    At the leaf, the evaluator is called if the game state is not terminal.
    A total of max_simulations states are explored.

    At every node, the algorithm chooses the action with the highest PUCT value,
    defined as: `Q/N + c * prior * sqrt(parent_N) / N`, where Q is the total
    reward after the action, and N is the number of times the action was
    explored in this position. The input parameter c controls the balance
    between exploration and exploitation; higher values of c encourage
    exploration of under-explored nodes. Unseen actions are always explored
    first.

    At the end of the search, the chosen action is the action that has been
    explored most often. This is the action that is returned.

    This implementation supports sequential n-player games, with or without
    chance nodes. All players maximize their own reward and ignore the other
    players' rewards. This corresponds to max^n for n-player games. It is the
    norm for zero-sum games, but doesn't have any special handling for
    non-zero-sum games. It doesn't have any special handling for imperfect
    information games.

    The implementation also supports backing up solved states, i.e. MCTS-Solver.
    The implementation is general in that it is based on a max^n backup (each
    player greedily chooses their maximum among proven children values, or there
    exists one child whose proven value is game.max_utility()), so it will work
    for multiplayer, general-sum, and arbitrary payoff games (not just win/loss/
    draw games). Also chance nodes are considered proven only if all children
    have the same value.

    Some references:
    - Sturtevant, An Analysis of UCT in Multi-Player Games,  2008,
      https://web.cs.du.edu/~sturtevant/papers/multi-player_UCT.pdf
    - Nijssen, Monte-Carlo Tree Search for Multi-Player Games, 2013,
      https://project.dke.maastrichtuniversity.nl/games/files/phd/Nijssen_thesis.pdf
    - Silver, AlphaGo Zero: Starting from scratch, 2017
      https://deepmind.com/blog/article/alphago-zero-starting-scratch
    - Winands, Bjornsson, and Saito, "Monte-Carlo Tree Search Solver", 2008.
      https://dke.maastrichtuniversity.nl/m.winands/documents/uctloa.pdf

    Arguments:
      state: pyspiel.State object, state to search from

    Returns:
      The most visited move from the root node.
    """</span>
    root_player <span class="token operator">=</span> state<span class="token punctuation">.</span>current_player<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root <span class="token operator">=</span> SearchNode<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> state<span class="token punctuation">.</span>current_player<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>max_simulations<span class="token punctuation">)</span><span class="token punctuation">:</span>
      visit_path<span class="token punctuation">,</span> working_state <span class="token operator">=</span> self<span class="token punctuation">.</span>_apply_tree_policy<span class="token punctuation">(</span>root<span class="token punctuation">,</span> state<span class="token punctuation">)</span>
      <span class="token keyword">if</span> working_state<span class="token punctuation">.</span>is_terminal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        returns <span class="token operator">=</span> working_state<span class="token punctuation">.</span>returns<span class="token punctuation">(</span><span class="token punctuation">)</span>
        visit_path<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>outcome <span class="token operator">=</span> returns
        solved <span class="token operator">=</span> self<span class="token punctuation">.</span>solve
      <span class="token keyword">else</span><span class="token punctuation">:</span>
        returns <span class="token operator">=</span> self<span class="token punctuation">.</span>evaluator<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>working_state<span class="token punctuation">)</span>
        solved <span class="token operator">=</span> <span class="token boolean">False</span>

      <span class="token keyword">for</span> node <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>visit_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        node<span class="token punctuation">.</span>total_reward <span class="token operator">+=</span> returns<span class="token punctuation">[</span>root_player <span class="token keyword">if</span> node<span class="token punctuation">.</span>player <span class="token operator">==</span>
                                     pyspiel<span class="token punctuation">.</span>PlayerId<span class="token punctuation">.</span>CHANCE <span class="token keyword">else</span> node<span class="token punctuation">.</span>player<span class="token punctuation">]</span>
        node<span class="token punctuation">.</span>explore_count <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token keyword">if</span> solved <span class="token keyword">and</span> node<span class="token punctuation">.</span>children<span class="token punctuation">:</span>
          player <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>player
          <span class="token keyword">if</span> player <span class="token operator">==</span> pyspiel<span class="token punctuation">.</span>PlayerId<span class="token punctuation">.</span>CHANCE<span class="token punctuation">:</span>
            <span class="token comment"># Only back up chance nodes if all have the same outcome.</span>
            <span class="token comment"># An alternative would be to back up the weighted average of</span>
            <span class="token comment"># outcomes if all children are solved, but that is less clear.</span>
            outcome <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>outcome
            <span class="token keyword">if</span> <span class="token punctuation">(</span>outcome <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span>
                <span class="token builtin">all</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>array_equal<span class="token punctuation">(</span>c<span class="token punctuation">.</span>outcome<span class="token punctuation">,</span> outcome<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> node<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
              node<span class="token punctuation">.</span>outcome <span class="token operator">=</span> outcome
            <span class="token keyword">else</span><span class="token punctuation">:</span>
              solved <span class="token operator">=</span> <span class="token boolean">False</span>
          <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># If any have max utility (won?), or all children are solved,</span>
            <span class="token comment"># choose the one best for the player choosing.</span>
            best <span class="token operator">=</span> <span class="token boolean">None</span>
            all_solved <span class="token operator">=</span> <span class="token boolean">True</span>
            <span class="token keyword">for</span> child <span class="token keyword">in</span> node<span class="token punctuation">.</span>children<span class="token punctuation">:</span>
              <span class="token keyword">if</span> child<span class="token punctuation">.</span>outcome <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                all_solved <span class="token operator">=</span> <span class="token boolean">False</span>
              <span class="token keyword">elif</span> best <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">or</span> child<span class="token punctuation">.</span>outcome<span class="token punctuation">[</span>player<span class="token punctuation">]</span> <span class="token operator">&gt;</span> best<span class="token punctuation">.</span>outcome<span class="token punctuation">[</span>player<span class="token punctuation">]</span><span class="token punctuation">:</span>
                best <span class="token operator">=</span> child
            <span class="token keyword">if</span> <span class="token punctuation">(</span>best <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span>
                <span class="token punctuation">(</span>all_solved <span class="token keyword">or</span> best<span class="token punctuation">.</span>outcome<span class="token punctuation">[</span>player<span class="token punctuation">]</span> <span class="token operator">==</span> self<span class="token punctuation">.</span>max_utility<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
              node<span class="token punctuation">.</span>outcome <span class="token operator">=</span> best<span class="token punctuation">.</span>outcome
            <span class="token keyword">else</span><span class="token punctuation">:</span>
              solved <span class="token operator">=</span> <span class="token boolean">False</span>
      <span class="token keyword">if</span> root<span class="token punctuation">.</span>outcome <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>

    <span class="token keyword">return</span> root<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="人类bot"><a href="#人类bot" class="headerlink" title="人类bot"></a>人类bot</h5><p>这部分为open_spiel所用的人类bot，修改了其中输入的部分，使其可以响应鼠标和语音输入。若选择鼠标输入，当鼠标点击时主动向bot传递参数。若选择语音输入，让bot向语音输入发出请求</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Copyright 2019 DeepMind Technologies Ltd. All rights reserved.</span>
<span class="token comment">#</span>
<span class="token comment"># Licensed under the Apache License, Version 2.0 (the "License");</span>
<span class="token comment"># you may not use this file except in compliance with the License.</span>
<span class="token comment"># You may obtain a copy of the License at</span>
<span class="token comment">#</span>
<span class="token comment">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="token comment">#</span>
<span class="token comment"># Unless required by applicable law or agreed to in writing, software</span>
<span class="token comment"># distributed under the License is distributed on an "AS IS" BASIS,</span>
<span class="token comment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="token comment"># See the License for the specific language governing permissions and</span>
<span class="token comment"># limitations under the License.</span>

<span class="token triple-quoted-string string">"""A bot that asks the user which action to play."""</span>

<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> absolute_import
<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> division
<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function

<span class="token keyword">import</span> math
<span class="token keyword">import</span> os

<span class="token keyword">import</span> pyspiel
<span class="token keyword">import</span> sys<span class="token punctuation">,</span> os
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> speechrecognition<span class="token punctuation">.</span>microphone_recognition <span class="token keyword">import</span> recognition

_MAX_WIDTH <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"COLUMNS"</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Get your TTY width.</span>


<span class="token keyword">def</span> <span class="token function">_print_columns</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Prints a list of strings in columns."""</span>
    padding <span class="token operator">=</span> <span class="token number">2</span>
    longest <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> strings<span class="token punctuation">)</span>
    max_columns <span class="token operator">=</span> math<span class="token punctuation">.</span>floor<span class="token punctuation">(</span><span class="token punctuation">(</span>_MAX_WIDTH <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>longest <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> padding<span class="token punctuation">)</span><span class="token punctuation">)</span>
    rows <span class="token operator">=</span> math<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span> <span class="token operator">/</span> max_columns<span class="token punctuation">)</span>
    columns <span class="token operator">=</span> math<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span> <span class="token operator">/</span> rows<span class="token punctuation">)</span>  <span class="token comment"># Might not fill all max_columns.</span>
    <span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>columns<span class="token punctuation">)</span><span class="token punctuation">:</span>
            i <span class="token operator">=</span> r <span class="token operator">+</span> c <span class="token operator">*</span> rows
            <span class="token keyword">if</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>strings<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" "</span> <span class="token operator">*</span> padding <span class="token operator">+</span>
                      strings<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span>longest <span class="token operator">+</span> padding<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">HumanBot</span><span class="token punctuation">(</span>pyspiel<span class="token punctuation">.</span>Bot<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Asks the user which action to play."""</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">=</span> <span class="token builtin">type</span>

    <span class="token keyword">def</span> <span class="token function">step_with_policy</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">,</span> _str<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Returns the stochastic policy and selected action in the given state."""</span>
        legal_actions <span class="token operator">=</span> state<span class="token punctuation">.</span>legal_actions<span class="token punctuation">(</span>state<span class="token punctuation">.</span>current_player<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> legal_actions<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pyspiel<span class="token punctuation">.</span>INVALID_ACTION
        p <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>legal_actions<span class="token punctuation">)</span>
        policy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token keyword">for</span> action <span class="token keyword">in</span> legal_actions<span class="token punctuation">]</span>

        action_map <span class="token operator">=</span> <span class="token punctuation">{</span>
            state<span class="token punctuation">.</span>action_to_string<span class="token punctuation">(</span>state<span class="token punctuation">.</span>current_player<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">:</span> action
            <span class="token keyword">for</span> action <span class="token keyword">in</span> legal_actions
        <span class="token punctuation">}</span>

        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Choose an action: "</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'mouse'</span><span class="token punctuation">:</span>
                action_str <span class="token operator">=</span> _str
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Legal actions(s):"</span><span class="token punctuation">)</span>
                longest_num <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> action <span class="token keyword">in</span> legal_actions<span class="token punctuation">)</span>
                _print_columns<span class="token punctuation">(</span><span class="token punctuation">[</span>
                    <span class="token string">"{}: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>longest_num<span class="token punctuation">)</span><span class="token punctuation">,</span> action_str<span class="token punctuation">)</span>
                    <span class="token keyword">for</span> action_str<span class="token punctuation">,</span> action <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>action_map<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span>
                action_str <span class="token operator">=</span> recognition<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> action_str<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Legal actions(s):"</span><span class="token punctuation">)</span>
                longest_num <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> action <span class="token keyword">in</span> legal_actions<span class="token punctuation">)</span>
                _print_columns<span class="token punctuation">(</span><span class="token punctuation">[</span>
                    <span class="token string">"{}: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>longest_num<span class="token punctuation">)</span><span class="token punctuation">,</span> action_str<span class="token punctuation">)</span>
                    <span class="token keyword">for</span> action_str<span class="token punctuation">,</span> action <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>action_map<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            <span class="token keyword">if</span> action_str <span class="token keyword">in</span> action_map<span class="token punctuation">:</span>
                <span class="token keyword">return</span> policy<span class="token punctuation">,</span> action_map<span class="token punctuation">[</span>action_str<span class="token punctuation">]</span>

            <span class="token keyword">try</span><span class="token punctuation">:</span>
                action <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>action_str<span class="token punctuation">)</span>
            <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Could not parse the action:"</span><span class="token punctuation">,</span> action_str<span class="token punctuation">)</span>
                <span class="token keyword">continue</span>

            <span class="token keyword">if</span> action <span class="token keyword">in</span> legal_actions<span class="token punctuation">:</span>
                <span class="token keyword">return</span> policy<span class="token punctuation">,</span> action

            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Illegal action selected:"</span><span class="token punctuation">,</span> action_str<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">step</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>step_with_policy<span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">restart_at</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="语音输入"><a href="#语音输入" class="headerlink" title="语音输入"></a>语音输入</h5><p>调用speech_recognition实现语音输入，选用的模型为中文模型，对得到的模型输出进行字符串解析转化为数字并传递给bot，在结果不符合要求时bot会再次请求语音输入</p>
<p>在选择语音输入时，每一步会提示合法的下一步对应的数字，例如在Tictactoe中</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Choose an action <span class="token punctuation">(</span>empty to print legal actions<span class="token punctuation">)</span>: 
Legal actions<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:
  <span class="token number">0</span>: o<span class="token punctuation">(</span><span class="token number">0,0</span><span class="token punctuation">)</span>    <span class="token number">2</span>: o<span class="token punctuation">(</span><span class="token number">0,2</span><span class="token punctuation">)</span>    <span class="token number">5</span>: o<span class="token punctuation">(</span><span class="token number">1,2</span><span class="token punctuation">)</span>    <span class="token number">7</span>: o<span class="token punctuation">(</span><span class="token number">2,1</span><span class="token punctuation">)</span>  
  <span class="token number">1</span>: o<span class="token punctuation">(</span><span class="token number">0,1</span><span class="token punctuation">)</span>    <span class="token number">3</span>: o<span class="token punctuation">(</span><span class="token number">1,0</span><span class="token punctuation">)</span>    <span class="token number">6</span>: o<span class="token punctuation">(</span><span class="token number">2,0</span><span class="token punctuation">)</span>    <span class="token number">8</span>: o<span class="token punctuation">(</span><span class="token number">2,2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>用中文读出对应的数字即可完成输入，例如 一、十、二十、三十一、一百、二百零三、三百一十、三百二十四</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> speech_recognition <span class="token keyword">as</span> sr


<span class="token keyword">def</span> <span class="token function">find</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'零'</span><span class="token punctuation">,</span> <span class="token string">'一'</span><span class="token punctuation">,</span> <span class="token string">'二'</span><span class="token punctuation">,</span> <span class="token string">'三'</span><span class="token punctuation">,</span> <span class="token string">'四'</span><span class="token punctuation">,</span> <span class="token string">'五'</span><span class="token punctuation">,</span> <span class="token string">'六'</span><span class="token punctuation">,</span> <span class="token string">'七'</span><span class="token punctuation">,</span> <span class="token string">'八'</span><span class="token punctuation">,</span> <span class="token string">'九'</span><span class="token punctuation">,</span> <span class="token string">'十'</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> value <span class="token operator">==</span> target<span class="token punctuation">:</span>
            <span class="token keyword">return</span> index
    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">def</span> <span class="token function">convert</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'"text" : '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'"'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'十'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token number">10</span> <span class="token operator">+</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'十'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
        <span class="token keyword">elif</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'百'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>
    <span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'十'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'百'</span> <span class="token keyword">and</span> result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'零'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'百'</span> <span class="token keyword">and</span> result<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'十'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span>
    <span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'百'</span> <span class="token keyword">and</span> result<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'十'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span> <span class="token operator">+</span> find<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">'error'</span>


<span class="token keyword">def</span> <span class="token function">recognition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># obtain audio from the microphone</span>
    r <span class="token operator">=</span> sr<span class="token punctuation">.</span>Recognizer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> sr<span class="token punctuation">.</span>Microphone<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> source<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Say something!"</span><span class="token punctuation">)</span>
        audio <span class="token operator">=</span> r<span class="token punctuation">.</span>listen<span class="token punctuation">(</span>source<span class="token punctuation">)</span>

    <span class="token comment"># recognize speech using Vosk</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> convert<span class="token punctuation">(</span>r<span class="token punctuation">.</span>recognize_vosk<span class="token punctuation">(</span>audio<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token keyword">except</span> sr<span class="token punctuation">.</span>UnknownValueError<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Vosk could not understand audio"</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> sr<span class="token punctuation">.</span>RequestError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Vosk error; {0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="Game类的实现"><a href="#Game类的实现" class="headerlink" title="Game类的实现"></a>Game类的实现</h5><p>Game类是五种游戏的基类，通过调用open_spiel库实现了游戏状态与游戏ai的初始化，游戏的进行与结果的判断</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> absolute_import
<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> division
<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">import</span> sys<span class="token punctuation">,</span> os
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> openspiel<span class="token punctuation">.</span>algorithms <span class="token keyword">import</span> mcts
<span class="token keyword">from</span> openspiel<span class="token punctuation">.</span>bots <span class="token keyword">import</span> human
<span class="token keyword">import</span> pyspiel


<span class="token keyword">class</span> <span class="token class-name">Game</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> show<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'mouse'</span><span class="token punctuation">,</span> simulations<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>game <span class="token operator">=</span> pyspiel<span class="token punctuation">.</span>load_game<span class="token punctuation">(</span>name<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span><span class="token builtin">type</span> <span class="token operator">=</span> <span class="token builtin">type</span>
        self<span class="token punctuation">.</span>bots <span class="token operator">=</span> <span class="token punctuation">[</span>
            self<span class="token punctuation">.</span>init_bot<span class="token punctuation">(</span><span class="token string">'mcts'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>game<span class="token punctuation">,</span> simulations<span class="token punctuation">)</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>init_bot<span class="token punctuation">(</span><span class="token string">'human'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>game<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>state <span class="token operator">=</span> self<span class="token punctuation">.</span>game<span class="token punctuation">.</span>new_initial_state<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show <span class="token operator">=</span> show
        self<span class="token punctuation">.</span>init_game<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">init_bot</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> bot_type<span class="token punctuation">,</span> game<span class="token punctuation">,</span> simulations<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Initializes a bot by type."""</span>
        rng <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>RandomState<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> bot_type <span class="token operator">==</span> <span class="token string">"mcts"</span><span class="token punctuation">:</span>
            evaluator <span class="token operator">=</span> mcts<span class="token punctuation">.</span>RandomRolloutEvaluator<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rng<span class="token punctuation">)</span>
            <span class="token keyword">return</span> mcts<span class="token punctuation">.</span>MCTSBot<span class="token punctuation">(</span>
                game<span class="token punctuation">,</span>
                <span class="token number">2</span><span class="token punctuation">,</span>
                simulations<span class="token punctuation">,</span>
                evaluator<span class="token punctuation">,</span>
                random_state<span class="token operator">=</span>rng<span class="token punctuation">,</span>
                solve<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                verbose<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> bot_type <span class="token operator">==</span> <span class="token string">"human"</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> human<span class="token punctuation">.</span>HumanBot<span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">)</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"Invalid bot type: %s"</span> <span class="token operator">%</span> bot_type<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">init_game</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Initial state:\n{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">play_game</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> position<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>is_terminal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span>
        current_player <span class="token operator">=</span> self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>current_player<span class="token punctuation">(</span><span class="token punctuation">)</span>
        bot <span class="token operator">=</span> self<span class="token punctuation">.</span>bots<span class="token punctuation">[</span>current_player<span class="token punctuation">]</span>
        action <span class="token operator">=</span> bot<span class="token punctuation">.</span>step<span class="token punctuation">(</span>self<span class="token punctuation">.</span>state<span class="token punctuation">,</span> position<span class="token punctuation">)</span>
        action_str <span class="token operator">=</span> self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>action_to_string<span class="token punctuation">(</span>current_player<span class="token punctuation">,</span> action<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Player {} sampled action: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
            current_player<span class="token punctuation">,</span> action_str<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i<span class="token punctuation">,</span> bot <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>bots<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i <span class="token operator">!=</span> current_player<span class="token punctuation">:</span>
                bot<span class="token punctuation">.</span>inform_action<span class="token punctuation">(</span>self<span class="token punctuation">.</span>state<span class="token punctuation">,</span> current_player<span class="token punctuation">,</span> action<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>apply_action<span class="token punctuation">(</span>action<span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Next state:\n{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>is_terminal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            overall_returns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>returns<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                overall_returns<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> v
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Overall returns"</span><span class="token punctuation">,</span> overall_returns<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="游戏类"><a href="#游戏类" class="headerlink" title="游戏类"></a>游戏类</h5><p>以下前五个游戏类的基类为Game，采用turtle库实现游戏界面，在基类的基础上根据不同的游戏设定了窗体大小，增加了grid、draw_black、draw_white、floor、draw、show、tap、_state、players、arr成员，它们的作用如下</p>
<blockquote>
<ul>
<li>grid 绘制游戏棋盘</li>
<li>draw_black、draw_white 绘制游戏双方的棋子</li>
<li>floor 对鼠标点击的坐标进行取整</li>
<li>draw 绘制棋子</li>
<li>tap 响应鼠标点击</li>
<li>_state 存储当前游戏方信息</li>
<li>players 用于棋子绘制</li>
<li>arr 保存当前盘面信息，防止在同一处再次落子</li>
</ul>
</blockquote>
<p>后两个小游戏是基于freegame库中的游戏拓展功能实现的</p>
<h6 id="Tictactoe"><a href="#Tictactoe" class="headerlink" title="Tictactoe"></a>Tictactoe</h6><p>井字棋由两名玩家轮流在 3×3 棋盘中标记空格为X或O。成功将三个标记放置在水平、垂直或对角线中的玩家为获胜者。</p>
<p><img src="image/Tictactoe.png" alt="Tictactoe.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> turtle
<span class="token keyword">import</span> sys<span class="token punctuation">,</span> os
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Game <span class="token keyword">import</span> Game


<span class="token keyword">class</span> <span class="token class-name">Tictactoe</span><span class="token punctuation">(</span>Game<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'mouse'</span><span class="token punctuation">,</span> simulations<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'player'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>players <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>drawx<span class="token punctuation">,</span> self<span class="token punctuation">.</span>drawo<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        turtle<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token number">420</span><span class="token punctuation">,</span> <span class="token number">420</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Tictactoe'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>hideturtle<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>tracer<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token string">'tic_tac_toe'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>show<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">,</span> simulations<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'mouse'</span><span class="token punctuation">:</span>
            turtle<span class="token punctuation">.</span>onscreenclick<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tap<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>is_terminal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>done<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">line</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>up<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>down<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">grid</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>line<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">67</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">200</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>line<span class="token punctuation">(</span><span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">200</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>line<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">67</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>line<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">drawx</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>line<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x <span class="token operator">+</span> <span class="token number">133</span><span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">133</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>line<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">133</span><span class="token punctuation">,</span> x <span class="token operator">+</span> <span class="token number">133</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">drawo</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>up<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">67</span><span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>down<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>circle<span class="token punctuation">(</span><span class="token number">62</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">floor</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">+</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">133</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">133</span> <span class="token operator">-</span> <span class="token number">200</span>

    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Draw X or O in tapped square."""</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        y <span class="token operator">=</span> self<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
        player <span class="token operator">=</span> self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span>
        draw <span class="token operator">=</span> self<span class="token punctuation">.</span>players<span class="token punctuation">[</span>player<span class="token punctuation">]</span>
        draw<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">not</span> player

    <span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
        turtle<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'x'</span> <span class="token keyword">else</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">133</span><span class="token operator">+</span>j<span class="token operator">*</span><span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">133</span><span class="token operator">-</span>i<span class="token operator">*</span><span class="token number">133</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">tap</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">133</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token punctuation">(</span>y <span class="token operator">+</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">133</span><span class="token punctuation">)</span>
        position <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span>position<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    Tictactoe<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="Go"><a href="#Go" class="headerlink" title="Go"></a>Go</h6><p>围棋使用矩形格状棋盘及黑白二色圆形棋子进行对弈，正规棋盘上有纵横各19条线段，361个交叉点，棋子必须走在空格非禁着点的交叉点上，双方交替行棋，落子后不能移动或悔棋，以目数多者为胜。</p>
<p><img src="image/Go.png" alt="Go.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> turtle
<span class="token keyword">import</span> sys<span class="token punctuation">,</span> os
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Game <span class="token keyword">import</span> Game


<span class="token keyword">class</span> <span class="token class-name">Go</span><span class="token punctuation">(</span>Game<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'mouse'</span><span class="token punctuation">,</span> simulations<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'player'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>players <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>draw_black<span class="token punctuation">,</span> self<span class="token punctuation">.</span>draw_white<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        turtle<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token number">760</span><span class="token punctuation">,</span> <span class="token number">760</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Go'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>hideturtle<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>tracer<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token string">'go'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>show<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">,</span> simulations<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'mouse'</span><span class="token punctuation">:</span>
            turtle<span class="token punctuation">.</span>onscreenclick<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tap<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>is_terminal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>done<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">grid</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>home<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 画横向</span>
            turtle<span class="token punctuation">.</span>up<span class="token punctuation">(</span><span class="token punctuation">)</span>
            turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">360</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">360</span><span class="token operator">+</span>i<span class="token operator">*</span><span class="token number">40</span><span class="token punctuation">)</span>
            turtle<span class="token punctuation">.</span>down<span class="token punctuation">(</span><span class="token punctuation">)</span>
            turtle<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">720</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>left<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 画竖向</span>
            turtle<span class="token punctuation">.</span>up<span class="token punctuation">(</span><span class="token punctuation">)</span>
            turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">360</span><span class="token operator">+</span>i<span class="token operator">*</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">360</span><span class="token punctuation">)</span>
            turtle<span class="token punctuation">.</span>down<span class="token punctuation">(</span><span class="token punctuation">)</span>
            turtle<span class="token punctuation">.</span>fd<span class="token punctuation">(</span><span class="token number">720</span><span class="token punctuation">)</span>

        turtle<span class="token punctuation">.</span>up<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 画标点</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">240</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">240</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">240</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw_black</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>dot<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw_white</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>down<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>circle<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>up<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">floor</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value <span class="token operator">+</span> <span class="token number">360</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">40</span> <span class="token operator">-</span> <span class="token number">360</span>

    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        y <span class="token operator">=</span> self<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
        player <span class="token operator">=</span> self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span>
        draw <span class="token operator">=</span> self<span class="token punctuation">.</span>players<span class="token punctuation">[</span>player<span class="token punctuation">]</span>
        draw<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">not</span> player

    <span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">]</span>
        turtle<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        i <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> substr <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
            j <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> ch <span class="token keyword">in</span> substr<span class="token punctuation">:</span>
                <span class="token keyword">if</span> ch <span class="token operator">==</span> <span class="token string">'+'</span><span class="token punctuation">:</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> ch <span class="token operator">==</span> <span class="token string">'X'</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
                    self<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">360</span><span class="token operator">+</span>j<span class="token operator">*</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token operator">-</span>i<span class="token operator">*</span><span class="token number">40</span><span class="token punctuation">)</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">elif</span><span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'O'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">360</span><span class="token operator">+</span>j<span class="token operator">*</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token operator">-</span>i<span class="token operator">*</span><span class="token number">40</span><span class="token punctuation">)</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token function">tap</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">360</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">+</span> <span class="token number">360</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span>
        position <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token operator">*</span><span class="token number">19</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span><span class="token number">18</span> <span class="token operator">-</span> y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span>position<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    Go<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="Y"><a href="#Y" class="headerlink" title="Y"></a>Y</h6><p>规则如下：</p>
<ul>
<li>玩家轮流在棋盘上放置一颗他们颜色的棋子。</li>
<li>一旦玩家连接了棋盘的所有三个面，游戏就结束并且该玩家获胜。角点属于它们相邻的板的两侧。</li>
</ul>
<p><img src="image/Y.png" alt="Y.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> turtle
<span class="token keyword">import</span> sys<span class="token punctuation">,</span> os
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Game <span class="token keyword">import</span> Game


<span class="token keyword">class</span> <span class="token class-name">Y</span><span class="token punctuation">(</span>Game<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'mouse'</span><span class="token punctuation">,</span> simulations<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'player'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>players <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>draw_black<span class="token punctuation">,</span> self<span class="token punctuation">.</span>draw_white<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        turtle<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Y'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>hideturtle<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>tracer<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>show<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">,</span> simulations<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'mouse'</span><span class="token punctuation">:</span>
            turtle<span class="token punctuation">.</span>onscreenclick<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tap<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>is_terminal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>done<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">hexagon</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>penup<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>pendown<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>circle<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> steps<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">grid</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>hexagon<span class="token punctuation">(</span><span class="token number">350</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>j<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw_black</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>fillcolor<span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>begin_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>hexagon<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>end_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw_white</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>fillcolor<span class="token punctuation">(</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>begin_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>hexagon<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>end_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        player <span class="token operator">=</span> self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span>
        draw <span class="token operator">=</span> self<span class="token punctuation">.</span>players<span class="token punctuation">[</span>player<span class="token punctuation">]</span>
        draw<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">not</span> player

    <span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span>
        turtle<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        i <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> substr <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
            j <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> ch <span class="token keyword">in</span> substr<span class="token punctuation">:</span>
                <span class="token keyword">if</span> ch <span class="token operator">==</span> <span class="token string">'.'</span><span class="token punctuation">:</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> ch <span class="token operator">==</span> <span class="token string">'O'</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
                    self<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token number">350</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>i<span class="token punctuation">)</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> ch <span class="token operator">==</span> <span class="token string">'@'</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token number">350</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>i<span class="token punctuation">)</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token function">tap</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
                X <span class="token operator">=</span> <span class="token number">350</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">)</span>
                Y <span class="token operator">=</span> <span class="token number">230</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>j
                <span class="token keyword">if</span> x <span class="token operator">&gt;=</span> X <span class="token operator">-</span> <span class="token number">20</span> <span class="token keyword">and</span> x <span class="token operator">&lt;=</span> X <span class="token operator">+</span> <span class="token number">20</span> <span class="token keyword">and</span> y <span class="token operator">&gt;=</span> Y <span class="token operator">-</span> <span class="token number">20</span> <span class="token keyword">and</span> y <span class="token operator">&lt;=</span> Y <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">:</span>
                    <span class="token keyword">if</span> x <span class="token operator">&gt;=</span> X <span class="token operator">-</span> <span class="token number">20</span> <span class="token keyword">and</span> x <span class="token operator">&lt;=</span> X<span class="token punctuation">:</span>
                        <span class="token keyword">if</span> y <span class="token operator">&gt;</span> Y <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>X<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> y <span class="token operator">&lt;</span> Y <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>X<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                            <span class="token keyword">if</span> self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token operator">-</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                                <span class="token keyword">return</span>
                            position <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token operator">*</span>j<span class="token operator">+</span><span class="token number">19</span><span class="token operator">-</span>i<span class="token punctuation">)</span>
                            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                                self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span>position<span class="token punctuation">)</span>
                            <span class="token keyword">return</span>
                    <span class="token keyword">elif</span> x <span class="token operator">&gt;=</span> X <span class="token keyword">and</span> x <span class="token operator">&lt;=</span> X <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">:</span>
                        <span class="token keyword">if</span> y <span class="token operator">&gt;</span> Y <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> y <span class="token operator">&lt;</span> Y <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                            <span class="token keyword">if</span> self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">19</span><span class="token operator">-</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                                <span class="token keyword">return</span>
                            position <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token operator">*</span>j<span class="token operator">+</span><span class="token number">19</span><span class="token operator">-</span>i<span class="token punctuation">)</span>
                            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                                self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span>position<span class="token punctuation">)</span>
                            <span class="token keyword">return</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    Y<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="Hex"><a href="#Hex" class="headerlink" title="Hex"></a>Hex</h6><p>它传统上在 11×11菱形板上进行。每个玩家都被分配了一对相对的棋盘面，他们必须轮流将一块与他们颜色相同的棋子放在任何空白处，以尝试将它们连接起来。一旦放置，石头就无法移动或移除。当玩家通过一连串相邻的棋子成功地将相对的棋盘面连接在一起时获胜。由于游戏板的拓扑结构，在 Hex 中无法进行平局。</p>
<p><img src="image/Hex.png" alt="Hex.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> turtle
<span class="token keyword">import</span> sys<span class="token punctuation">,</span> os
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Game <span class="token keyword">import</span> Game


<span class="token keyword">class</span> <span class="token class-name">Hex</span><span class="token punctuation">(</span>Game<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'mouse'</span><span class="token punctuation">,</span> simulations<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'player'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>players <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>draw_black<span class="token punctuation">,</span> self<span class="token punctuation">.</span>draw_white<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        turtle<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Hex'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>hideturtle<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>tracer<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>show<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">,</span> simulations<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'mouse'</span><span class="token punctuation">:</span>
            turtle<span class="token punctuation">.</span>onscreenclick<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tap<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>is_terminal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>done<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">hexagon</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>penup<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>pendown<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>circle<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> steps<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">grid</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>hexagon<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">250</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>j<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>i<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw_black</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>fillcolor<span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>begin_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>hexagon<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>end_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw_white</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>fillcolor<span class="token punctuation">(</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>begin_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>hexagon<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>end_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        player <span class="token operator">=</span> self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span>
        draw <span class="token operator">=</span> self<span class="token punctuation">.</span>players<span class="token punctuation">[</span>player<span class="token punctuation">]</span>
        draw<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">not</span> player

    <span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        i <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> substr <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
            j <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> ch <span class="token keyword">in</span> substr<span class="token punctuation">:</span>
                <span class="token keyword">if</span> ch <span class="token operator">==</span> <span class="token string">'.'</span><span class="token punctuation">:</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> ch <span class="token operator">==</span> <span class="token string">'x'</span> <span class="token keyword">or</span> ch <span class="token operator">==</span> <span class="token string">'y'</span> <span class="token keyword">or</span> ch <span class="token operator">==</span> <span class="token string">'z'</span> <span class="token keyword">or</span> ch <span class="token operator">==</span> <span class="token string">'X'</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
                    self<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">250</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>j<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>i<span class="token punctuation">)</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> ch <span class="token operator">==</span> <span class="token string">'o'</span> <span class="token keyword">or</span> ch <span class="token operator">==</span> <span class="token string">'p'</span> <span class="token keyword">or</span> ch <span class="token operator">==</span> <span class="token string">'q'</span> <span class="token keyword">or</span> ch <span class="token operator">==</span> <span class="token string">'O'</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">250</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>j<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>i<span class="token punctuation">)</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token function">tap</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                X <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">250</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>j<span class="token operator">+</span>i<span class="token punctuation">)</span>
                Y <span class="token operator">=</span> <span class="token number">150</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>i
                <span class="token keyword">if</span> x <span class="token operator">&gt;=</span> X <span class="token operator">-</span> <span class="token number">20</span> <span class="token keyword">and</span> x <span class="token operator">&lt;=</span> X <span class="token operator">+</span> <span class="token number">20</span> <span class="token keyword">and</span> y <span class="token operator">&gt;=</span> Y <span class="token operator">-</span> <span class="token number">20</span> <span class="token keyword">and</span> y <span class="token operator">&lt;=</span> Y <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">:</span>
                    <span class="token keyword">if</span> x <span class="token operator">&gt;=</span> X <span class="token operator">-</span> <span class="token number">20</span> <span class="token keyword">and</span> x <span class="token operator">&lt;=</span> X<span class="token punctuation">:</span>
                        <span class="token keyword">if</span> y <span class="token operator">&gt;</span> Y <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>X<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> y <span class="token operator">&lt;</span> Y <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>X<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                            <span class="token keyword">if</span> self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                                <span class="token keyword">return</span>
                            position <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">11</span><span class="token operator">+</span>j<span class="token punctuation">)</span>
                            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                                self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span>position<span class="token punctuation">)</span>
                            <span class="token keyword">return</span>
                    <span class="token keyword">elif</span> x <span class="token operator">&gt;=</span> X <span class="token keyword">and</span> x <span class="token operator">&lt;=</span> X <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">:</span>
                        <span class="token keyword">if</span> y <span class="token operator">&gt;</span> Y <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> y <span class="token operator">&lt;</span> Y <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                            <span class="token keyword">if</span> self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                                <span class="token keyword">return</span>
                            position <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">11</span><span class="token operator">+</span>j<span class="token punctuation">)</span>
                            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                                self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span>position<span class="token punctuation">)</span>
                            <span class="token keyword">return</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    Hex<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="Havannah"><a href="#Havannah" class="headerlink" title="Havannah"></a>Havannah</h6><p>规则如下：</p>
<ul>
<li>每位玩家每回合将一颗与其颜色相同的棋子放在棋盘上。</li>
<li>棋子永远不会被移动、捕获或以其他方式改变。</li>
<li>当玩家完成三个不同结构中的一个时获胜：<ul>
<li>环，围绕一个或多个单元格的循环（无论被包围的单元格是否被任何玩家占据或空）；</li>
<li>桥，连接棋盘六个角点中的任意两个；</li>
<li>叉子，连接棋盘的任意三个边缘；角点不被视为边缘的一部分。</li>
</ul>
</li>
</ul>
<p><img src="image/Havannah_1.png" alt="Havannah_1.png"></p>
<p><img src="image/Havannah_2.png" alt="Havannah_2.png"></p>
<p><img src="image/Havannah_3.png" alt="Havannah_3.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> turtle
<span class="token keyword">import</span> sys<span class="token punctuation">,</span> os
sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> Game <span class="token keyword">import</span> Game


<span class="token keyword">class</span> <span class="token class-name">Havannah</span><span class="token punctuation">(</span>Game<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">'mouse'</span><span class="token punctuation">,</span> simulations<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'player'</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>players <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>draw_black<span class="token punctuation">,</span> self<span class="token punctuation">.</span>draw_white<span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        turtle<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Havannah'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>hideturtle<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>tracer<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token string">'havannah'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>show<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">,</span> simulations<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">type</span> <span class="token operator">==</span> <span class="token string">'mouse'</span><span class="token punctuation">:</span>
            turtle<span class="token punctuation">.</span>onscreenclick<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tap<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>state<span class="token punctuation">.</span>is_terminal<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>done<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">hexagon</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>penup<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>pendown<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>circle<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> steps<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">grid</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> <span class="token number">7</span> <span class="token keyword">and</span> j <span class="token operator">&lt;=</span> <span class="token number">7</span> <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">8</span> <span class="token keyword">and</span> j <span class="token operator">&gt;=</span> i <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>hexagon<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">125</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>j<span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>i<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw_black</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>fillcolor<span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>begin_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>hexagon<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>end_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw_white</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>fillcolor<span class="token punctuation">(</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>begin_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>hexagon<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>end_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        player <span class="token operator">=</span> self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span>
        draw <span class="token operator">=</span> self<span class="token punctuation">.</span>players<span class="token punctuation">[</span>player<span class="token punctuation">]</span>
        draw<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">not</span> player

    <span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span>
        turtle<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>
        i <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> substr <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
            j <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">if</span> i <span class="token operator">&lt;=</span> <span class="token number">7</span> <span class="token keyword">else</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> ch <span class="token keyword">in</span> substr<span class="token punctuation">:</span>
                <span class="token keyword">if</span> ch <span class="token operator">==</span> <span class="token string">'.'</span><span class="token punctuation">:</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">elif</span> ch <span class="token operator">==</span> <span class="token string">'O'</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
                    self<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">125</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>j<span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>i<span class="token punctuation">)</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">elif</span><span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token string">'@'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>_state<span class="token punctuation">[</span><span class="token string">'player'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">125</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>j<span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>i<span class="token punctuation">)</span>
                    j <span class="token operator">+=</span> <span class="token number">1</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token function">tap</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> <span class="token number">7</span> <span class="token keyword">and</span> j <span class="token operator">&lt;=</span> <span class="token number">7</span> <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">8</span> <span class="token keyword">and</span> j <span class="token operator">&gt;=</span> i <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    X <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">125</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>j<span class="token operator">-</span>i<span class="token punctuation">)</span>
                    Y <span class="token operator">=</span> <span class="token number">200</span><span class="token operator">-</span><span class="token number">30</span><span class="token operator">*</span>i
                    <span class="token keyword">if</span> x <span class="token operator">&gt;=</span> X <span class="token operator">-</span> <span class="token number">20</span> <span class="token keyword">and</span> x <span class="token operator">&lt;=</span> X <span class="token operator">+</span> <span class="token number">20</span> <span class="token keyword">and</span> y <span class="token operator">&gt;=</span> Y <span class="token operator">-</span> <span class="token number">20</span> <span class="token keyword">and</span> y <span class="token operator">&lt;=</span> Y <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">:</span>
                        <span class="token keyword">if</span> x <span class="token operator">&gt;=</span> X <span class="token operator">-</span> <span class="token number">20</span> <span class="token keyword">and</span> x <span class="token operator">&lt;=</span> X<span class="token punctuation">:</span>
                            <span class="token keyword">if</span> y <span class="token operator">&gt;</span> Y <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>X<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> y <span class="token operator">&lt;</span> Y <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>X<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                                <span class="token keyword">if</span> self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                                    <span class="token keyword">return</span>
                                position <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">15</span><span class="token operator">+</span>j<span class="token punctuation">)</span>
                                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                                    self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span>position<span class="token punctuation">)</span>
                                <span class="token keyword">return</span>
                        <span class="token keyword">elif</span> x <span class="token operator">&gt;=</span> X <span class="token keyword">and</span> x <span class="token operator">&lt;=</span> X <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">:</span>
                            <span class="token keyword">if</span> y <span class="token operator">&gt;</span> Y <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">-</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> y <span class="token operator">&lt;</span> Y <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                                <span class="token keyword">if</span> self<span class="token punctuation">.</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                                    <span class="token keyword">return</span>
                                position <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">15</span><span class="token operator">+</span>j<span class="token punctuation">)</span>
                                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                                    self<span class="token punctuation">.</span>play_game<span class="token punctuation">(</span>position<span class="token punctuation">)</span>
                                <span class="token keyword">return</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    Havannah<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="Free-Python-Games"><a href="#Free-Python-Games" class="headerlink" title="Free Python Games"></a>Free Python Games</h5><p>项目对原 Free Python Games 中大部分的游戏进行了升级处理，并对Free Python Games中的paint与snake进行拓展</p>
<h6 id="paint"><a href="#paint" class="headerlink" title="paint"></a>paint</h6><p>该程序通过键盘来控制颜色、形状、是否填充：K、W、G、B、R分别代表颜色黑、白、绿、蓝、红；l、s、c、r、t分别代表形状线段、正方形、圆、长方形、三角形；f代表所化封闭图形需要填充；F则代表不用填充。</p>
<p>圆形、长方形、三角形与填充选项为拓展。</p>
<ul>
<li><p>圆形：通过图上鼠标点击的两点得到半径，第二个点为圆心而得到目标的图形。</p>
</li>
<li><p>长方形：通过图上鼠标点击的两点得到目标图形的对角的两个点，进行绘制。</p>
</li>
<li><p>三角形：通过图上鼠标点击的三个点得到目标图形的三个顶点。 </p>
</li>
</ul>
<p><img src="image/paint.png" alt="paint.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> turtle
<span class="token keyword">import</span> math
<span class="token keyword">from</span> freegames <span class="token keyword">import</span> vector


<span class="token keyword">def</span> <span class="token function">line</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Draw line from start to end."""</span>

    turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>end<span class="token punctuation">.</span>x<span class="token punctuation">,</span> end<span class="token punctuation">.</span>y<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">square</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Draw square from start to end."""</span>
    <span class="token keyword">for</span> count <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        turtle<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>end<span class="token punctuation">.</span>x <span class="token operator">-</span> start<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
        turtle<span class="token punctuation">.</span>left<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">circle</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Draw circle from start to end."""</span>
    r <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end<span class="token punctuation">.</span>x <span class="token operator">-</span> start<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end<span class="token punctuation">.</span>y <span class="token operator">-</span> start<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">0.5</span>
    angle <span class="token operator">=</span> math<span class="token punctuation">.</span>atan2<span class="token punctuation">(</span>end<span class="token punctuation">.</span>x <span class="token operator">-</span> start<span class="token punctuation">.</span>x<span class="token punctuation">,</span> end<span class="token punctuation">.</span>y <span class="token operator">-</span> start<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    angle <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>angle <span class="token operator">*</span> <span class="token number">180</span><span class="token operator">/</span>math<span class="token punctuation">.</span>pi<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>right<span class="token punctuation">(</span>angle<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>r<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>left<span class="token punctuation">(</span>angle<span class="token punctuation">)</span>
    <span class="token keyword">pass</span>  <span class="token comment"># TODO</span>


<span class="token keyword">def</span> <span class="token function">rectangle</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Draw rectangle from start to end."""</span>

    turtle<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>end<span class="token punctuation">.</span>x <span class="token operator">-</span> start<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>left<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>end<span class="token punctuation">.</span>y <span class="token operator">-</span> start<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>left<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>end<span class="token punctuation">.</span>x <span class="token operator">-</span> start<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>left<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>end<span class="token punctuation">.</span>y <span class="token operator">-</span> start<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>left<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span>
    <span class="token keyword">pass</span>  <span class="token comment"># TODO</span>


<span class="token keyword">def</span> <span class="token function">triangle</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Draw triangle from start to end."""</span>
    turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>middle<span class="token punctuation">.</span>x<span class="token punctuation">,</span> middle<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>end<span class="token punctuation">.</span>x<span class="token punctuation">,</span> end<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>start<span class="token punctuation">.</span>x<span class="token punctuation">,</span> start<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    <span class="token keyword">pass</span>  <span class="token comment"># TODO</span>


<span class="token keyword">def</span> <span class="token function">tap</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Store starting point or draw shape."""</span>
    start <span class="token operator">=</span> state<span class="token punctuation">[</span><span class="token string">'start'</span><span class="token punctuation">]</span>
    middle <span class="token operator">=</span> state<span class="token punctuation">[</span><span class="token string">'middle'</span><span class="token punctuation">]</span>
    shape <span class="token operator">=</span> state<span class="token punctuation">[</span><span class="token string">'shape'</span><span class="token punctuation">]</span>

    <span class="token keyword">if</span> state<span class="token punctuation">[</span><span class="token string">'shape'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> triangle<span class="token punctuation">:</span>
        <span class="token keyword">if</span> start <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            state<span class="token punctuation">[</span><span class="token string">'start'</span><span class="token punctuation">]</span> <span class="token operator">=</span> vector<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            shape <span class="token operator">=</span> state<span class="token punctuation">[</span><span class="token string">'shape'</span><span class="token punctuation">]</span>
            end <span class="token operator">=</span> vector<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
            draw_shape<span class="token punctuation">(</span>start<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span>
            state<span class="token punctuation">[</span><span class="token string">'start'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> start <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            state<span class="token punctuation">[</span><span class="token string">'start'</span><span class="token punctuation">]</span> <span class="token operator">=</span> vector<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> middle <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            state<span class="token punctuation">[</span><span class="token string">'middle'</span><span class="token punctuation">]</span> <span class="token operator">=</span> vector<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            shape <span class="token operator">=</span> state<span class="token punctuation">[</span><span class="token string">'shape'</span><span class="token punctuation">]</span>
            end <span class="token operator">=</span> vector<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
            draw_shape<span class="token punctuation">(</span>start<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span>
            state<span class="token punctuation">[</span><span class="token string">'start'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
            state<span class="token punctuation">[</span><span class="token string">'middle'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
            
<span class="token keyword">def</span> <span class="token function">draw_shape</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">:</span>
    turtle<span class="token punctuation">.</span>up<span class="token punctuation">(</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>goto<span class="token punctuation">(</span>start<span class="token punctuation">.</span>x<span class="token punctuation">,</span> start<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>down<span class="token punctuation">(</span><span class="token punctuation">)</span>
    shape <span class="token operator">=</span> state<span class="token punctuation">[</span><span class="token string">'shape'</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> state<span class="token punctuation">[</span><span class="token string">'fill'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'yes'</span><span class="token punctuation">:</span>
    	turtle<span class="token punctuation">.</span>begin_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>

    shape<span class="token punctuation">(</span>start<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> end<span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> state<span class="token punctuation">[</span><span class="token string">'fill'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'yes'</span><span class="token punctuation">:</span>
    	turtle<span class="token punctuation">.</span>end_fill<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">store</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Store value in state at key."""</span>
    state<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#state = {'start': None, 'middle': None, 'shape': line, 'fill': 'no'}</span>
    turtle<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token number">420</span><span class="token punctuation">,</span> <span class="token number">420</span><span class="token punctuation">,</span> <span class="token number">370</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onscreenclick<span class="token punctuation">(</span>tap<span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span>turtle<span class="token punctuation">.</span>undo<span class="token punctuation">,</span> <span class="token string">'u'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> turtle<span class="token punctuation">.</span>color<span class="token punctuation">(</span><span class="token string">'black'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'K'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> turtle<span class="token punctuation">.</span>color<span class="token punctuation">(</span><span class="token string">'white'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'W'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> turtle<span class="token punctuation">.</span>color<span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> turtle<span class="token punctuation">.</span>color<span class="token punctuation">(</span><span class="token string">'blue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> turtle<span class="token punctuation">.</span>color<span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'R'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> store<span class="token punctuation">(</span><span class="token string">'shape'</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> store<span class="token punctuation">(</span><span class="token string">'shape'</span><span class="token punctuation">,</span> square<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> store<span class="token punctuation">(</span><span class="token string">'shape'</span><span class="token punctuation">,</span> circle<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> store<span class="token punctuation">(</span><span class="token string">'shape'</span><span class="token punctuation">,</span> rectangle<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> store<span class="token punctuation">(</span><span class="token string">'shape'</span><span class="token punctuation">,</span> triangle<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'t'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> store<span class="token punctuation">(</span><span class="token string">'fill'</span><span class="token punctuation">,</span> <span class="token string">'yes'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'f'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> store<span class="token punctuation">(</span><span class="token string">'fill'</span><span class="token punctuation">,</span> <span class="token string">'no'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">)</span>
    turtle<span class="token punctuation">.</span>done<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'start'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'middle'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'shape'</span><span class="token punctuation">:</span> line<span class="token punctuation">,</span> <span class="token string">'fill'</span><span class="token punctuation">:</span> <span class="token string">'no'</span><span class="token punctuation">}</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>

    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h6><p>该游戏为贪吃蛇，基于源程序拓展了以下功能：</p>
<ul>
<li>当蛇头碰到一边的边界后会从另一个边界出来，即蛇不会因碰到边界而游戏失败。</li>
<li>蛇只可以转向它前进方向的左边和右边，即按动与前进方向相反的方向键后，蛇不会死亡且不改变移动方向。</li>
<li>蛇在死亡后可以按’r’键原地复活，但身体长度回到初始；按’q’，直接退出游戏。</li>
</ul>
<p><img src="image/snake1.png" alt="snake1.png"></p>
<p><img src="image/snake2.png" alt="snake2.png"></p>
<p><img src="image/snake3.png" alt="snake3.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> randrange
<span class="token keyword">from</span> turtle <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> sys

<span class="token keyword">from</span> freegames <span class="token keyword">import</span> square<span class="token punctuation">,</span> vector

food <span class="token operator">=</span> vector<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
snake <span class="token operator">=</span> <span class="token punctuation">[</span>vector<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
aim <span class="token operator">=</span> vector<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span>
turnning <span class="token operator">=</span> <span class="token number">0</span>


<span class="token keyword">def</span> <span class="token function">change</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Change snake direction."""</span>
    <span class="token keyword">global</span> turnning
    <span class="token keyword">if</span> turnning <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span>
    turnning <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">if</span> x <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> aim<span class="token punctuation">.</span>x <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> x <span class="token operator">+</span> aim<span class="token punctuation">.</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        turnning <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">return</span>
    <span class="token keyword">elif</span> y <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> aim<span class="token punctuation">.</span>y <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> y <span class="token operator">+</span> aim<span class="token punctuation">.</span>y <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        turnning <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">return</span>
    aim<span class="token punctuation">.</span>x <span class="token operator">=</span> x
    aim<span class="token punctuation">.</span>y <span class="token operator">=</span> y
    turnning <span class="token operator">=</span> <span class="token number">0</span>


<span class="token keyword">def</span> <span class="token function">inside</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Return True if head inside boundaries."""</span>
    <span class="token keyword">if</span> head<span class="token punctuation">.</span>x <span class="token operator">&lt;=</span> <span class="token operator">-</span><span class="token number">200</span><span class="token punctuation">:</span>
        head<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">190</span>
    <span class="token keyword">elif</span> head<span class="token punctuation">.</span>x <span class="token operator">&gt;=</span> <span class="token number">190</span><span class="token punctuation">:</span>
        head<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">200</span>
    <span class="token keyword">elif</span> head<span class="token punctuation">.</span>y <span class="token operator">&lt;=</span> <span class="token operator">-</span><span class="token number">200</span><span class="token punctuation">:</span>
        head<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">190</span>
    <span class="token keyword">elif</span> head<span class="token punctuation">.</span>y <span class="token operator">&gt;=</span> <span class="token number">190</span><span class="token punctuation">:</span>
        head<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">200</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">200</span> <span class="token operator">&lt;=</span> head<span class="token punctuation">.</span>x <span class="token operator">&lt;=</span> <span class="token number">190</span> <span class="token keyword">and</span> <span class="token operator">-</span><span class="token number">200</span> <span class="token operator">&lt;=</span> head<span class="token punctuation">.</span>y <span class="token operator">&lt;=</span> <span class="token number">190</span>


<span class="token keyword">def</span> <span class="token function">direction</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> aim<span class="token punctuation">.</span>x <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">10</span> <span class="token keyword">and</span> key <span class="token operator">==</span> <span class="token string">'Right'</span><span class="token punctuation">:</span>
        change<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> aim<span class="token punctuation">.</span>x <span class="token operator">!=</span> <span class="token number">10</span> <span class="token keyword">and</span> key <span class="token operator">==</span> <span class="token string">'Left'</span><span class="token punctuation">:</span>
        change<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> aim<span class="token punctuation">.</span>y <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">10</span> <span class="token keyword">and</span> key <span class="token operator">==</span> <span class="token string">'Up'</span><span class="token punctuation">:</span>
        change<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> aim<span class="token punctuation">.</span>y <span class="token operator">!=</span> <span class="token number">10</span> <span class="token keyword">and</span> key <span class="token operator">==</span> <span class="token string">'Down'</span><span class="token punctuation">:</span>
        change<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Move snake forward one segment."""</span>
    head <span class="token operator">=</span> snake<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    head<span class="token punctuation">.</span>move<span class="token punctuation">(</span>aim<span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token keyword">not</span> inside<span class="token punctuation">(</span>head<span class="token punctuation">)</span> <span class="token keyword">or</span> head <span class="token keyword">in</span> snake<span class="token punctuation">:</span>
        square<span class="token punctuation">(</span>head<span class="token punctuation">.</span>x<span class="token punctuation">,</span> head<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">)</span>
        update<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ontimer<span class="token punctuation">(</span>restart<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>


    snake<span class="token punctuation">.</span>append<span class="token punctuation">(</span>head<span class="token punctuation">)</span>
    <span class="token keyword">if</span> head <span class="token operator">==</span> food<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Snake:'</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>snake<span class="token punctuation">)</span><span class="token punctuation">)</span>
        food<span class="token punctuation">.</span>x <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
        food<span class="token punctuation">.</span>y <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        snake<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    clear<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> body <span class="token keyword">in</span> snake<span class="token punctuation">:</span>
        square<span class="token punctuation">(</span>body<span class="token punctuation">.</span>x<span class="token punctuation">,</span> body<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'black'</span><span class="token punctuation">)</span>

    square<span class="token punctuation">(</span>food<span class="token punctuation">.</span>x<span class="token punctuation">,</span> food<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'green'</span><span class="token punctuation">)</span>
    update<span class="token punctuation">(</span><span class="token punctuation">)</span>
    ontimer<span class="token punctuation">(</span>move<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'tape r to restart;tape q to exit'</span><span class="token punctuation">)</span>
    listen<span class="token punctuation">(</span><span class="token punctuation">)</span>
    onkey<span class="token punctuation">(</span>main<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
    onkey<span class="token punctuation">(</span>exit<span class="token punctuation">,</span> <span class="token string">'q'</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> turnning 
    turnnong <span class="token operator">=</span> <span class="token number">0</span>
    setup<span class="token punctuation">(</span><span class="token number">420</span><span class="token punctuation">,</span> <span class="token number">420</span><span class="token punctuation">,</span> <span class="token number">370</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>snake<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> body <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>snake<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            snake<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    reset<span class="token punctuation">(</span><span class="token punctuation">)</span>
    hideturtle<span class="token punctuation">(</span><span class="token punctuation">)</span>
    tracer<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    listen<span class="token punctuation">(</span><span class="token punctuation">)</span>
    onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> change<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Right'</span><span class="token punctuation">)</span>
    onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> change<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Left'</span><span class="token punctuation">)</span>
    onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> change<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Up'</span><span class="token punctuation">)</span>
    onkey<span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> change<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Down'</span><span class="token punctuation">)</span>
    move<span class="token punctuation">(</span><span class="token punctuation">)</span>
    done<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="总结与展望"><a href="#总结与展望" class="headerlink" title="总结与展望"></a>总结与展望</h2><p>本项目实现了一个统一的接口封装图形化界面、ai与语音识别，在避免复杂逻辑的情况下减少三者的耦合，从而使得项目易于学习与拓展。项目中作为例子实现了open_spiel的蒙特卡罗算法调用，Tictactoe, Go, Y, Hex, Havannah五个双人策略游戏，对Free Python Games中的paint与snake进行拓展，对原 Free Python Games 中大部分的游戏进行了升级处理，基于线下Vosk的语音识别。未来基于现有的接口可以方便的引入其它的强化学习、搜索、最优化、估值算法，补充支持的游戏，增加语音识别api。项目在Windows11和 Ubuntu 20.04.4 LTS 上测试通过，具有较高的可扩展性与可移植性。</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Hyjwpk</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://hyjwpk.github.io/2022/08/01/python-game/">http://hyjwpk.github.io/2022/08/01/python-game/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Hyjwpk</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/python/">
                                    <span class="chip bg-color">python</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/08/02/tu-xiang-chu-li-shang-ji-bao-gao/">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="图像处理上机报告">
                        
                        <span class="card-title">图像处理上机报告</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-08-02
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%AE%9E%E9%AA%8C/" class="post-category">
                                    实验
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/matlab/">
                        <span class="chip bg-color">matlab</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/01/24/huffman-bian-ma/">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/5.jpg" class="responsive-img" alt="Huffman 编码">
                        
                        <span class="card-title">Huffman 编码</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-01-24
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E5%A4%A7%E4%BD%9C%E4%B8%9A/" class="post-category">
                                    大作业
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/qt/">
                        <span class="chip bg-color">qt</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="2722795475"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <span id="year">2023</span>
            <a href="/about" target="_blank">Hyjwpk</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">44.3k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/hyjwpk" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:2359105286@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2359105286" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2359105286" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

    <script src="https://cdn.jsdelivr.net/gh/hyjwpk/hyjwpk.github.io@main/js/prism.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/hyjwpk/hyjwpk.github.io@main/js/snow.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>

    <script type="text/javascript">
        var OriginTitile=document.title,st;
        document.addEventListener("visibilitychange",function(){
            document.hidden?(document.title="<(￣︶￣)>偷偷藏起来",clearTimeout(st)):(document.title="(*/ω＼*)被发现了",st=setTimeout(function(){document.title=OriginTitile},3e3))
        })
    </script>

</body>

</html>
